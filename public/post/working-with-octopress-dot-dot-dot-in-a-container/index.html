  <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Working with octopress... in a container. &middot; Lars Cromley </title>
    
    <link rel="stylesheet" type="text/css" href="http://callmeradical.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://callmeradical.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://callmeradical.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="http://callmeradical.com/favicon.ico">
    
    
    <script src="http://callmeradical.com/js/jquery.min.js"></script>
    <script src="http://callmeradical.com/js/main.min.js">
    </script>
</head>

  <body>
    <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/bg.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://callmeradical.com/" title="link to homepage for Lars Cromley"> <img src="http://callmeradical.com/images/logo.jpg" width="80" alt="Lars Cromley logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://callmeradical.com/"  title="link to homepage for Lars Cromley">Lars Cromley</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  Technologist, evangelist, and all around nerd. These thoughts are my own and do not reflect that of my employer.  </p>
                <hr class="panel-cover__divider panel-cover__divider--secondary" />
                <div class="navigation-wrapper">
                    <nav class="cover-navigation cover-navigation--primary">
                        <ul class="navigation">
                            <li class="navigation__item"><a href="http://callmeradical.com#blog" title="link to Lars Cromley blog" class="blog-button">Blog</a> </li>
                            
                       </ul>
                    </nav> <nav class="cover-navigation navigation--social">
    
      
      <a href="http://twitter.com/callmeradical" title="@callmeradical on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
       
       
      
        
        <a href="https://github.com/callmeradical" title="callmeradical on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
       
       
      
        
        <a href="http://no.linkedin.com/in/larscromley/en" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
       
      
        
        <a href="mailto:lars@callmeradical.com" title="Email lars@callmeradical.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
       
</nav>
 </div>
            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/bg.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://callmeradical.com/" title="link to homepage for Lars Cromley"> <img src="http://callmeradical.com/images/logo.jpg" width="80" alt="Lars Cromley logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://callmeradical.com/"  title="link to homepage for Lars Cromley">Lars Cromley</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  Technologist, evangelist, and all around nerd. These thoughts are my own and do not reflect that of my employer.  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                            <ul class="navigation">
                                <li class="navigation__item"><a href="http://callmeradical.com/#blog" title="link to Lars Cromley blog" class="blog-button">Blog</a> </li></br>
                                
                                
                           </ul>
                        <nav class="cover-navigation navigation--social">
    
      
      <a href="http://twitter.com/callmeradical" title="@callmeradical on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
       
       
      
        
        <a href="https://github.com/callmeradical" title="callmeradical on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
       
       
      
        
        <a href="http://no.linkedin.com/in/larscromley/en" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
       
      
        
        <a href="mailto:lars@callmeradical.com" title="Email lars@callmeradical.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
       
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <div class="post">
          <h1>Working with octopress... in a container.</h1>
          <span class="post-date">Fri, Sep 25, 2015</span>
          <p>So I have been on a bit of a kick with Docker. I have been in Boston talking
about it, giving webinars on it, and using it just about everywhere in every
which way I can.</p>

<p>One of the first things I realized is that I hate installing dependencies on
all of my things. Installing ruby, git, gcc, and not to mention all the gems
that I need to run.</p>

<p>I decided the first thing I wanted to do was make it easier to write my blog
(which is already ridiculously easy, thanks Github!), I also just wanted to
see if I could run my blog outside of Github pages if the need arises.
<!-- more -->
So here we go.</p>

<p><a href="Octopress">www.octopress.org</a> is/was a blogging framework largely based on
<a href="Jekyll">www.jekyllrb.com</a>. Since then it has been replaced with a variety
of Gems.</p>

<p>Dockerfile</p>

<pre><code>FROM debian:8.1

RUN apt-get update
RUN apt-get install -y \
  git \
  ruby \
  ruby-dev \
  rubygems \
  build-essential \
  nodejs \
  python

RUN git clone https://github.com/callmeradical/callmeradical.github.io
WORKDIR callmeradical.github.io

RUN git checkout source
RUN /bin/bash -l -c &quot;gem install bundler&quot;
RUN /bin/bash -l -c &quot;bundle install&quot;

EXPOSE 4000

RUN apt-get autoremove -y
RUN useradd -ms /bin/bash lars
USER lars
ENTRYPOINT [&quot;/usr/local/bin/rake&quot;, &quot;preview&quot; ]
</code></pre>

<p>We can look at this a little closer for those that have never written a Dockerfile before.
The very first line:</p>

<pre><code>FROM debian:8.1
</code></pre>

<p>Tells me that I am inheritting from another container. All the configuration that went into
making that container can be viewed on <a href="Docker Hub">hub.docker.com</a>.</p>

<p>So that will get me to a base install of the OS. The next few lines are pretty self
explanatory. I am installing packages necessary for the my application to run.</p>

<pre><code>RUN apt-get update
RUN apt-get install -y \
  git \
  ruby \
  ruby-dev \
  rubygems \
  build-essential \
  nodejs \
  python


</code></pre>

<p>Now we are ready to clone in our project:</p>

<pre><code>RUN git clone https://github.com/callmeradical/callmeradical.github.io
WORKDIR callmeradical.github.io

RUN git checkout source
</code></pre>

<p>I am using github pages to deploy my blog and it builds &lsquo;master&rsquo; from &lsquo;source&rsquo; so
I check out the source branch and install my gems..</p>

<pre><code>RUN /bin/bash -l -c &quot;gem install bundler&quot;
RUN /bin/bash -l -c &quot;bundle install&quot;
</code></pre>

<p>EXPOSE Docker that the container will listen on the specified network ports at runtime.
Docker uses this information to interconnect containers using links, which is helpful if
we decide we want to run our blog in a more traditional way fronted by Nginx or apache.</p>

<p>Finally I add a user with the same username as my local machine, this is pretty important.</p>

<pre><code>EXPOSE 4000

RUN useradd -ms /bin/bash lars
USER lars
ENTRYPOINT [&quot;/usr/local/bin/rake&quot;, &quot;preview&quot; ]
</code></pre>

<p>Now I add this file to my octopress blog repo and I can now build my container:</p>

<pre><code>docker build --rm=true -t callmeradical/blog:latest .
</code></pre>

<p>That might take a little bit to install the packages and deps, but once that is complete
I can now run my blog locally while editing/working on posts.</p>

<pre><code>docker run -i -t \
-v ~/src/1_docker_callmeradical.github.io:/callmeradical.github.io \ 
-p 80:4000 \
-d --name blog callmeradical/blog              
</code></pre>

<p>This might look unusual at first but there is a reason why I am running it this way.
I can perform all my edits locally and the preview will continue to regenerate the view
for me. Combine that my transparent terminal, I can see whats happening as I am posting.</p>

<p>Now if I have to interact in a different way to say do a deployment, or generate a new
post, I can just use</p>

<pre><code>docker exec -ti &lt;command&gt;
</code></pre>

        </div>
        <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=Working%20with%20octopress...%20in%20a%20container.-http%3a%2f%2fcallmeradical.com%2fpost%2fworking-with-octopress-dot-dot-dot-in-a-container%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-2x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fcallmeradical.com%2fpost%2fworking-with-octopress-dot-dot-dot-in-a-container%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-2x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fcallmeradical.com%2fpost%2fworking-with-octopress-dot-dot-dot-in-a-container%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-2x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fcallmeradical.com%2fpost%2fworking-with-octopress-dot-dot-dot-in-a-container%2f&title=Working%20with%20octopress...%20in%20a%20container." target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-2x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fcallmeradical.com%2fpost%2fworking-with-octopress-dot-dot-dot-in-a-container%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-2x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fcallmeradical.com%2fpost%2fworking-with-octopress-dot-dot-dot-in-a-container%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-2x">
</span></a>
</div>

        



      </div>
    </div>

  </body>
  
</html>
