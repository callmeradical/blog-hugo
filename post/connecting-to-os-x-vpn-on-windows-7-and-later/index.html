<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Connecting to OS X VPN on Windows 7 and Later | Lars Cromley</title><link rel=stylesheet href=https://cromleylabs.com/css/style.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/github.min.css><section class=section><div class=container><nav class=nav><div class=nav-left><a class=nav-item href=https://cromleylabs.com><h1 class="title is-4">Lars Cromley</h1></a></div><div class=nav-right><nav class="nav-item level is-mobile"><a class=level-item href=/about><span class=icon><i class="fa fa-id-badge"></i></span></a><a class=level-item href=/disclaimer><span class=icon><i class="fa fa-exclamation-circle"></i></span></a><a class=level-item href=https://github.com/callmeradical><span class=icon><i class="fa fa-github"></i></span></a><a class=level-item href=https://twitter.com/callmeradical><span class=icon><i class="fa fa-twitter"></i></span></a><a class=level-item href=/index.xml><span class=icon><i class="fa fa-rss"></i></span></a></nav></div></nav></div></section><section class=section><div class=container><h2 class="subtitle is-6">November 25, 2013</h2><h1 class=title>Connecting to OS X VPN on Windows 7 and Later</h1><div class=content><p>When setting up windows machine&rsquo;s for VPN access to OS X server&rsquo;s builtin VPN service there is some tweaking that I have always found necessary.</p><ol><li>Add this to your registry:</li></ol><p><code>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\PolicyAgent]
&quot;AssumeUDPEncapsulationContextOnSendRule&quot;=dword:00000002</code></p><ol><li>Open secpol.msc (click start &gt; search for secpol.msc)</li></ol><ul><li>Local Policies &gt; Security Options</li><li>Network Security : LAN Manager Auth Level…</li><li>Set to: Send LM &amp; NTLMv2 - UseNTLMv2…</li></ul><p>And</p><ul><li>Network Security : Minimum session security… clients</li><li>uncheck &ldquo;Require 128-bit encryption&rdquo;</li></ul><ol><li><p>Restart PC</p></li><li><p>Create VPN Connection on Windows 7</p></li></ol><ul><li>Host Name: (server IP or yourhost.name.com)</li><li>PPP Settings : Enable LCP (only)</li><li>Type: L2TP/IPSec</li><li>Pre-shared key : yoursharedsecret</li><li>Data encryption : Optional encryption</li><li>Allow CHAO and CHAPv2</li></ul><ol><li>Router on server-side must allow VPN Passthrough and forward ports: 50, 51, 500, 548, 1701, 1723, 4500 to the server box. Also, do not filter anonymous internet requests, multicast or NAT Redirection but enable SPI Firewall.</li></ol><p>Following these steps should produce a working VPN connection on Windows 7 when connecting to a VPN provided by OS X server.</p></div></div></section><section class=section><div class=container><aside><div id=disqus_thread></div></aside><script type=text/javascript>var disqus_shortname='callmeradical';(function(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></section><section class=section><div class="container has-text-centered"><p>&copy; <a href=https://github.com/callmeradical>Lars Cromley</a> 2017</p></div></section><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/languages/go.min.js></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/languages/dockerfile.min.js></script><script>hljs.initHighlightingOnLoad();</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-159931755-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script>